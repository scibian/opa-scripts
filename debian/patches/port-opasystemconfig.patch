Description: Port opasystemconfig to Debian
 opasystemconfig, as deivered in RHEL IFS, doesn't work correctly on
 Debian due to different config paths and some rc-style services.
 This patch corrects these issues.
Author: Brian T. Smith <bsmith@systemfabricworks.com>
Forwarded: not-needed
Last-Update: <2018-07-02>
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/opasystemconfig
+++ b/opasystemconfig
@@ -58,8 +58,13 @@
 		fi
 }
 
+if [ -f /etc/debian_version ] ; then
+IRQFILE=/etc/default/irqbalance
+IRQBAKFILE=/etc/default/irqbalance.bak
+else
 IRQFILE=/etc/sysconfig/irqbalance
 IRQBAKFILE=/etc/sysconfig/irqbalance.bak
+fi
 IRQ_ARGS_VALUE="hintpolicy=exact"
 #Irq_balance
 function Irq_Balance_SysConfig_Enable(){
@@ -127,12 +132,16 @@
 		if $(echo ${service_output} | grep -q 'unrecognized service'); then
 			local status="notfound"
 		else
-			chkconfig irqbalance
+			local status=$(chkconfig irqbalance 2>&1)
 			local status_rc=$?
 			if [ $status_rc -eq 0 ];then
-				local status="enabled"
-			elif [ $status_rc -eq 1 ]; then
-				local status="disabled"
+				if $(echo ${status} | grep -q ' on$'); then
+					status="enabled"
+				elif $(echo ${status} | grep -q ' off$'); then
+					status="disabled"
+				fi
+			else
+				status = "error"
 			fi
 		fi
 	else
@@ -150,7 +159,7 @@
 }
 
 #Memory Limit
-APPEND_FILE=/etc/sysconfig/opa/limits.conf
+APPEND_FILE=/etc/opa/limits.conf
 LIMIT_FILE=/etc/security/limits.conf
 LIMIT_BAKFILE=/etc/security/limits.conf.bak
 
@@ -180,7 +189,7 @@
 }
 
 #Udev Access
-SOURCE_FILE=/etc/sysconfig/opa/udev.rules
+SOURCE_FILE=/etc/opa/udev.rules
 RULE_FILE=/etc/udev/rules.d/05-opa.rules
 
 function Udev_Access_SysConfig_Enable(){	
